<tool id="MIRNA" name="miRNASelection" version="20.05">
    <!-- <description>selects promising miRNA candidates</description> -->

    <command detect_errors="exit_code"><![CDATA[
		bash ${__tool_directory__}/scripts/twoMethods.sh
            --curpath ${__tool_directory__}
            --mirmerge $mergemiRNA
            --expfile $expfile
            --stemloop $criteria.stemloop
            --structure $criteria.structure
            --abias $criteria.abias
            --sbias $criteria.sbias
            --minlen $criteria.minlen
            --maxlen $criteria.maxlen
            #if $mlbase.mlinput.positive == "no":
                --positive $mlbase.mlinput.limit
            #end if
            --nuval $mlbase.nu
            --outfile $outfile

    ]]></command>

    <inputs>
        <param name="mergemiRNA" type="data" format="tabular" label="Candidate miRNAs generated by miRNATranslate" />
        <param name="expfile" type="data" format="tar" label="Read abundance data generated by miRNAPredict" />

        <section name="criteria" title="Parameters for high-throughput criteria" expanded="false">
            <param name="stemloop" type="text" value="300" label="Foldback size" />
            <param name="structure" type="boolean" truevalue="yes" falsevalue="no" checked="true" label="Effective RNA structure of miRNA:miRNA*" />
            <param name="abias" type="float" value="0.75" label="Abundance bias (0-1)" />
            <param name="sbias" type="float" value="0.90" label="Strand bias (0-1)" />
            <param name="minlen" type="integer" value="20" label="Minimum miRNA length (18-26)" />
            <param name="maxlen" type="integer" value="24" label="Maximum miRNA length (18-26)" />
        </section>

        <section name="mlbase" title="Parameters for machine learning-based approaches" expanded="false">
            <conditional name="mlinput">
                <param name="positive" type="boolean" truevalue="yes" falsevalue="no"
                        checked="true" label="All miRNAs from databases as positive samples?" />
                <when value="no">
                    <param name="limit" type="data" label="The name of the positive samples" />
                </when>
            </conditional>
            <param name="nu" type="float" value="0.7" label="Proportion of miRNAs with characteristics similar to positive samples (0-1)" />
        </section>
    </inputs>

    <stdio><exit_code range="1:" level="fatal" description="Error Running ${tool.name}"/></stdio>

    <outputs>
        <data name="outfile" format="tabular" label="${tool.name} | Selected miRNAs based on two methods"></data>
    </outputs>

<help><![CDATA[

.. class:: donemark

**What it does**

This tool provides two strategies to select promising miRNA candidates:

    i) High-throughput criteria;
    ii) Machine learning-based approaches.

.. class:: infomark

**Inputs**

- **miRNA annotation file:** MiRNA information in a tab-delimited file.
- **The expression file:** A compressed folder containing the expression levels of sequences in each library.
- **The detailed parameters of high-throughput criteria and machine learning-based approach**

.. class:: infomark

**Output**

An annotation file containing miRNA information and classification results of high-throughput criteria and/or machine learning-based approaches.

|

    ]]></help>

    <citations>
        <citation type="doi">10.1105/tpc.17.00851</citation>
        <citation type="doi">10.1371/journal.pone.0142753</citation>
        <citation type="doi">10.1186/s12859-014-0423-x</citation>
    </citations>

</tool>
